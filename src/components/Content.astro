---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

const { data } = Astro.props;
const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/*.{jpeg,jpg,png,gif}"
);
if (!images[data.imagePath])
  throw new Error(
    `"${data.imagePath}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`
  );

// Can we define what the difference is between Content, Content2, and Content3 is?
---

<div
  class="relative isolate overflow-hidden bg-white px-6 py-24 sm:py-32 lg:overflow-visible lg:px-0"
>
  <div
    class="mx-auto grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 lg:mx-0 lg:max-w-none lg:grid-cols-2 lg:items-start lg:gap-y-10"
  >
    <div
      class="lg:col-span-2 lg:col-start-1 lg:row-start-1 lg:mx-auto lg:grid lg:w-full lg:max-w-7xl lg:grid-cols-2 lg:gap-x-8 lg:px-8"
    >
      <div class="lg:pr-4">
        <div class="lg:max-w-lg">
          <p class="subtitle">
            {data.upperHeading}
          </p>
          <h2 class="title">
            {data.heading}
          </h2>
          <p
            class="mt-6 text-xl leading-8 text-gray-700"
            set:html={data.description}
          />
        </div>
      </div>
    </div>
    <div
      class="-ml-12 -mt-12 p-12 lg:sticky lg:top-0 lg:col-start-2 lg:row-span-2 lg:row-start-1 lg:overflow-hidden"
    >
      <Image
        src={images[data.imagePath]()}
        alt={data.imageAlt}
        class="w-3xl max-w-2xl rounded-md bg-gray-900 shadow-xl ring-1 ring-gray-400/10 sm:w-228"
        quality={100}
      />
    </div>
    <div
      class="lg:col-span-2 lg:col-start-1 lg:row-start-2 lg:mx-auto lg:grid lg:w-full lg:max-w-7xl lg:grid-cols-2 lg:gap-x-8 lg:px-8"
    >
      <div class="lg:pr-4">
        <div class="max-w-xl text-base leading-7 text-gray-700 lg:max-w-lg">
          {
            data.paragraphs && (
              <div>
                {data.paragraphs.map((paragraph: string) => (
                  <p class="mt-2" set:html={paragraph} />
                ))}
              </div>
            )
          }
          {
            data.list && (
              <div class="mt-8">
                <h4 class="text-2xl font-bold tracking-tight text-mariner-600">
                  {data.list.heading}
                </h4>
                <ul role="list" class="mt-4 space-y-8 text-gray-600 max-w-md">
                  {data.list.items.map(
                    (item: {
                      icon: string | null | undefined;
                      title: string;
                      descriptions: any[];
                    }) => (
                      <li class="flex gap-x-3">
                        <svg
                          class="mt-1 size-8 flex-none text-amber-400"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                          aria-hidden="true"
                        >
                          <path
                            fill-rule="evenodd"
                            d={item.icon}
                            clip-rule="evenodd"
                          />
                        </svg>
                        <span class="leading-snug">
                          <strong class="font-bold text-mariner-900 tracking-tight uppercase">
                            {item.title}
                          </strong>{" "}
                          {item.descriptions.map((dec: unknown) => (
                            <p class="mb-2" set:html={dec} />
                          ))}
                        </span>
                      </li>
                    )
                  )}
                </ul>
              </div>
            )
          }
          {
            data.afterListParagraphs && (
              <div class="mt-8">
                {data.afterListParagraphs.map((paragraph: unknown) => (
                  <p class="mt-2" set:html={paragraph} />
                ))}
              </div>
            )
          }
          {
            data.finalSection && (
              <>
                <h3 class="mt-16 text-2xl font-bold tracking-tight text-mariner-600">
                  {data.finalSection.heading}
                </h3>
                <div class="mt-6">
                  {data.finalSection.descriptions.map((desc: unknown) => (
                    <p class="mt-2" set:html={desc} />
                  ))}
                </div>
              </>
            )
          }
          {
            data.finalCta && (
              <div class="mt-16">
                <a href={data.finalCta.href} class="btn-primary">
                  {data.finalCta.text}
                </a>
              </div>
            )
          }
        </div>
      </div>
    </div>
  </div>
</div>
